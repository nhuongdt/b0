"use strict";(self.webpackChunklayout_jsx=self.webpackChunklayout_jsx||[]).push([[4822],{21487:(n,a,e)=>{e.d(a,{Z:()=>p});var i=e(47313),t=e(48623),o=e(24631),h=e(9019),l=e(61113),s=e(9506),d=e(88706),r=e(80280),u=e(85905),c=e(8922),T=e(29390),m=e(46417);function p(n){let{type:a,idChosed:e,handleChoseItem:p,label:x,helperText:g="",err:v=!1}=n;const[Z,C]=(0,i.useState)([]),[y,f]=(0,i.useState)(null),[j,D]=(0,i.useState)({keyword:"",maxResultCount:50,skipCount:0,sortBy:"",sortType:""}),N=(0,i.useRef)((0,d.Z)((async n=>{switch(a){case"tenant":{const a=await T.Z.getAll(n);if(null!==a){const n=a.items.map((n=>({id:n.id,text1:n.name,text2:n.tenancyName})));C(n)}}break;case"brandname":{const a=await c.Z.GetListBandname(n);if(null!==a){const n=a.items.map((n=>({id:n.id,text1:n.brandname,text2:n.sdtCuaHang})));C(n)}}}}),500)).current;i.useEffect((()=>{N(j)}),[j.keyword]),i.useEffect((()=>{(async()=>{if(r.Z.checkNull(e)||e===u.i.EMPTY)f((()=>null));else switch(a){case"tenant":if(0!==e){const n=await T.Z.get(e);if(null!==n){const a={id:n.id,text1:n.name,text2:n.tenancyName};f(a)}}else f(null);break;case"brandname":{const n=await c.Z.GetInforBrandnamebyID(e);if(null!==n){const a={id:n.id,text1:n.brandname,text2:n.sdtCuaHang};f(a)}}}})()}),[e]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(t.Z,{size:"small",fullWidth:!0,disablePortal:!0,autoComplete:!0,multiple:!1,value:y,onChange:(n,a)=>{p(a)},onInputChange:(n,a)=>{(n=>{D({...j,keyword:n})})(a)},filterOptions:n=>n,options:Z,getOptionLabel:n=>n.text1?n.text1:"",renderInput:n=>(0,m.jsx)(o.Z,{...n,label:null!==x&&void 0!==x?x:"T\xecm ki\u1ebfm",helperText:g,error:v}),renderOption:(n,a)=>(0,i.createElement)("li",{...n,key:a.id,style:{borderBottom:"1px dashed var(--border-color)"}},(0,m.jsx)(h.ZP,{container:!0,alignItems:"center",children:(0,m.jsxs)(h.ZP,{item:!0,sx:{width:"calc(100% - 44px)",wordWrap:"break-word"},children:[(0,m.jsx)(l.Z,{style:{fontSize:"13px"},children:a.text1}),(0,m.jsx)(s.Z,{component:"span",style:{fontWeight:500,color:"#acaca5",fontSize:"12px"},children:a.text2})]})}))})})}},48127:(n,a,e)=>{e.d(a,{Z:()=>o});var i=e(10298),t=e(46417);function o(n){let{onClose:a}=n;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(i.Z,{onClick:a,sx:{position:"absolute",right:"16px",top:"16px",minWidth:20,"&:hover":{filter:"brightness(0) saturate(100%) invert(34%) sepia(44%) saturate(2405%) hue-rotate(316deg) brightness(98%) contrast(92%)"}}})})}},88200:(n,a,e)=>{e.d(a,{Z:()=>T});var i=e(47313),t=e(47131),o=e(85582),h=e(51405),l=e(61113),s=e(78957),d=e(88989),r=e(71207),u=e(57605),c=e(46417);function T(n){let{handleAction:a,lstOption:e}=n;const[T,m]=i.useState(null),p=Boolean(T),x=n=>{m(null),a(n)};return(0,c.jsxs)("div",{children:[(0,c.jsx)(t.Z,{id:"demo-positioned-button","aria-controls":p?"demo-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":p?"true":void 0,onClick:n=>{m(n.currentTarget)},children:(0,c.jsx)(s.Z,{})}),(0,c.jsx)(o.Z,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:T,open:p,onClose:()=>m(null),children:e&&e.length>0?(0,c.jsx)("div",{children:null===e||void 0===e?void 0:e.map(((n,a)=>(0,c.jsxs)(h.Z,{onClick:()=>x(parseInt(n.id)),children:[(0,c.jsx)(l.Z,{color:null===n||void 0===n?void 0:n.color,fontSize:"12px",variant:"button",textTransform:"unset",width:"64px",fontWeight:"400",marginRight:"8px",children:n.text}),n.icon]},a)))}):(0,c.jsxs)("div",{children:[(0,c.jsxs)(h.Z,{onClick:()=>x(0),children:[(0,c.jsx)(l.Z,{color:"#009EF7",fontSize:"12px",variant:"button",textTransform:"unset",width:"64px",fontWeight:"400",marginRight:"8px",children:"Xem"}),(0,c.jsx)(d.Z,{sx:{color:"#009EF7"}})]}),(0,c.jsxs)(h.Z,{onClick:()=>x(1),children:[(0,c.jsx)(l.Z,{color:"#009EF7",fontSize:"12px",variant:"button",textTransform:"unset",width:"64px",fontWeight:"400",marginRight:"8px",children:"S\u1eeda"}),(0,c.jsx)(r.Z,{sx:{color:"#009EF7"}})]}),(0,c.jsxs)(h.Z,{onClick:()=>x(2),children:[(0,c.jsx)(l.Z,{color:"#F1416C",fontSize:"12px",variant:"button",textTransform:"unset",width:"64px",fontWeight:"400",marginRight:"8px",children:"X\xf3a"}),(0,c.jsx)(u.Z,{sx:{color:"#F1416C"}})]})]})})]})}},2538:(n,a,e)=>{e.d(a,{Z:()=>s});var i=e(1550),t=e(23306),o=e(40454),h=e(51405),l=e(46417);function s(n){let{idChosed:a,data:e,handleChange:s,label:d}=n;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(i.Z,{fullWidth:!0,size:"small",children:[(0,l.jsx)(t.Z,{sx:{fontSize:"15px"},children:d}),(0,l.jsx)(o.Z,{value:a,label:d,children:null===e||void 0===e?void 0:e.map(((n,a)=>(0,l.jsx)(h.Z,{value:n.value,onClick:()=>(n=>{s(n)})(n),children:n.text},a)))})]})})}},65296:(n,a,e)=>{e.d(a,{Z:()=>K});var i=e(94469),t=e(33604),o=e(9506),h=e(96467),l=e(9019),s=e(24631),d=e(16429),r=e(83929),u=e(44758),c=e(35898),T=e(24193),m=e(7410),p=e(47313),x=e(62870),g=e(80280),v=e(4031),Z=e(21933),C=e(89600),y=e(69551),f=e(85905),j=e(2447),D=e(87068),N=e(93857),b=e(12731),w=e(82739),H=e(95104),B=e(2538),k=e(48127),P=e(21487),_=e(68186),S=e(93737),I=e(8922),L=e(46417);const K=n=>{let{visiable:a=!1,idQuyHD:e=null,onClose:K,onOk:E}=n;const M=(0,p.useContext)(j.Il).chinhanhCurrent,[F,W]=(0,p.useState)({show:!1,title:"",type:1,mes:""}),[z,G]=(0,p.useState)({show:!1,type:1,mes:""}),[V,R]=(0,p.useState)(new b.Z({id:f.i.create().toString(),idChiNhanh:M.id,idLoaiChungTu:11,tongTienThu:0,idDoiTuongNopTien:null,hinhThucThanhToan:1,hachToanKinhDoanh:!0,ngayLapHoaDon:(0,C.Z)(new Date,"yyyy-MM-dd HH:mm")})),q=11===(null===V||void 0===V?void 0:V.idLoaiChungTu)?"thu":"chi";(0,p.useEffect)((()=>{}),[]),(0,p.useEffect)((()=>{g.Z.checkNull(e)?R({...V,id:f.i.create().toString(),idChiNhanh:M.id,idLoaiChungTu:11,tongTienThu:0,idDoiTuongNopTien:null,maHoaDon:"",loaiDoiTuong:1,ngayLapHoaDon:(0,C.Z)(new Date,"yyyy-MM-dd HH:mm"),noiDungThu:"",hinhThucThanhToan:1,idKhoanThuChi:null,idTaiKhoanNganHang:null,hachToanKinhDoanh:!0}):a&&(async()=>{if(g.Z.checkNull(e))return;const n=await w.Z.GetInforQuyHoaDon_byId(null!==e&&void 0!==e?e:"");if(null!==n){const e=n.quyHoaDon_ChiTiet;var a,i,t,o;void 0!==e&&(null===e||void 0===e?void 0:e.length)>0&&R({...V,id:n.id,idChiNhanh:n.idChiNhanh,idBrandname:n.idBrandname,idLoaiChungTu:n.idLoaiChungTu,ngayLapHoaDon:n.ngayLapHoaDon,maHoaDon:n.maHoaDon,noiDungThu:n.noiDungThu,tongTienThu:n.tongTienThu,hachToanKinhDoanh:n.hachToanKinhDoanh,loaiDoiTuong:null!=(null===(a=e[0])||void 0===a?void 0:a.idNhanVien)?3:1,idDoiTuongNopTien:null!=(null===(i=e[0])||void 0===i?void 0:i.idNhanVien)?null===(t=e[0])||void 0===t?void 0:t.idNhanVien:null===(o=e[0])||void 0===o?void 0:o.idKhachHang,hinhThucThanhToan:e[0].hinhThucThanhToan,idKhoanThuChi:e[0].idKhoanThuChi,idTaiKhoanNganHang:e[0].idTaiKhoanNganHang,quyHoaDon_ChiTiet:e})}})()}),[a]);const O=async n=>{if(!g.Z.checkNull(n.idBrandname)){const a=await I.Z.GetInforBrandnamebyID(n.idBrandname);if(null!==a){const e={tenantId:a.tenantId,idPhieuNapTien:n.id,soTienChuyen_Nhan:n.tongTienThu,thoiGianNap_ChuyenTien:n.ngayLapHoaDon,noiDungChuyen_Nhan:n.noiDungThu},i=S.Z.ThemMoi_CapNhatPhieuNapTien(a.tenantId,e);console.log("naptien ",i)}}};(0,p.useEffect)((()=>{R({...V,loaiPhieu:11===V.idLoaiChungTu?"Phi\u1ebfu thu":"Phi\u1ebfu chi"})}),[V.idLoaiChungTu]),(0,p.useEffect)((()=>{var n;R({...V,sHinhThucThanhToan:null===(n=y.ZP.hinhThucThanhToan.filter((n=>n.value===V.hinhThucThanhToan))[0])||void 0===n?void 0:n.text})}),[V.hinhThucThanhToan]);const Q=Z.Ry().shape({idBrandname:Z.Z_().required("Vui l\xf2ng ch\u1ecdn brandname"),tongTienThu:Z.Rx().transform(((n,a)=>g.Z.formatNumberToFloat(a))).notOneOf([0],"T\u1ed5ng ti\u1ec1n ph\u1ea3i > 0").required("Vui l\xf2ng nh\u1eadp s\u1ed1 ti\u1ec1n")});return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(_.Z,{showAlert:z.show,type:z.type,title:z.mes,handleClose:()=>G({show:!1,mes:"",type:1})}),(0,L.jsx)(D.Z,{isShow:F.show,title:F.title,mes:F.mes,onOk:()=>{W({...F,show:!1}),E(V,3)},onCancel:()=>W({...F,show:!1})}),(0,L.jsxs)(i.Z,{open:a,fullWidth:!0,maxWidth:"sm",onClose:K,children:[(0,L.jsxs)(t.Z,{children:[(0,L.jsxs)(o.Z,{className:"modal-title",sx:{float:"left"},children:[g.Z.checkNull(e)?"Th\xeam m\u1edbi":"C\u1eadp nh\u1eadt"," phi\u1ebfu n\u1ea1p ti\u1ec1n"]}),(0,L.jsx)(k.Z,{onClose:K})]}),(0,L.jsx)(h.Z,{children:(0,L.jsx)(m.J9,{initialValues:V,validationSchema:Q,onSubmit:async n=>{if(!await(async n=>{if(!g.Z.checkNull(n)){const a=await w.Z.CheckExistsMaPhieuThuChi(null!==n&&void 0!==n?n:"",e);if(a)return G({show:!0,mes:"M\xe3 phi\u1ebfu thu \u0111\xe3 t\u1ed3n t\u1ea1i",type:2}),!a}return!0})(null===n||void 0===n?void 0:n.maHoaDon))return;const a=g.Z.formatNumberToFloat(n.tongTienThu),i={...n},t=3==n.loaiDoiTuong?null:n.idDoiTuongNopTien,o=3==n.loaiDoiTuong?n.idDoiTuongNopTien:null;if(i.tongTienThu=a,g.Z.checkNull(e)){const e=new H.Z({idKhachHang:t,hinhThucThanhToan:n.hinhThucThanhToan,tienThu:a,idNhanVien:o,idKhoanThuChi:n.idKhoanThuChi,idTaiKhoanNganHang:n.idTaiKhoanNganHang});i.quyHoaDon_ChiTiet=[e];const h=await w.Z.CreateQuyHoaDon(i);n.id=h.id,n.maHoaDon=h.maHoaDon,n.txtTrangThai="\u0110\xe3 thanh to\xe1n",i.id=h.id,E(n,1)}else{var h;i.quyHoaDon_ChiTiet=null===(h=V.quyHoaDon_ChiTiet)||void 0===h?void 0:h.map((e=>({id:e.id,idQuyHoaDon:e.idQuyHoaDon,idKhachHang:t,hinhThucThanhToan:n.hinhThucThanhToan,tienThu:a,idNhanVien:o,idKhoanThuChi:n.idKhoanThuChi,diemThanhToan:e.diemThanhToan,chiPhiNganHang:e.chiPhiNganHang,idTaiKhoanNganHang:n.idTaiKhoanNganHang,laPTChiPhiNganHang:e.laPTChiPhiNganHang,thuPhiTienGui:e.thuPhiTienGui})));const e=await w.Z.UpdateQuyHoaDon(i);n.id=e.id,n.maHoaDon=e.maHoaDon,n.txtTrangThai="\u0110\xe3 thanh to\xe1n",E(n,2)}await O(i)},enableReinitialize:!0,children:n=>{let{isSubmitting:a,handleChange:i,values:t,errors:o,touched:h,setFieldValue:p}=n;return(0,L.jsx)(m.l0,{children:(0,L.jsxs)(l.ZP,{container:!0,spacing:2,marginTop:.5,children:[(0,L.jsx)(l.ZP,{item:!0,xs:12,children:(0,L.jsx)(P.Z,{type:"brandname",label:"Ch\u1ecdn brandname",idChosed:t.idBrandname,handleChoseItem:n=>{p("idBrandname",n.id)},helperText:h.idBrandname&&o.idBrandname,err:o.idBrandname})}),(0,L.jsx)(l.ZP,{item:!0,xs:6,sm:6,children:(0,L.jsx)(s.Z,{size:"small",fullWidth:!0,label:"M\xe3 phi\u1ebfu",value:t.maHoaDon,onChange:n=>{p("maHoaDon",n.target.value)},helperText:h.maHoaDon&&o.maHoaDon})}),(0,L.jsx)(l.ZP,{item:!0,xs:6,sm:6,children:(0,L.jsx)(v.Z,{props:{width:"100%"},defaultVal:t.ngayLapHoaDon,labelText:"Ng\xe0y l\u1eadp phi\u1ebfu",handleChangeDate:n=>{p("ngayLapHoaDon",n)},helperText:h.idDoiTuongNopTien&&o.idDoiTuongNopTien})}),(0,L.jsx)(l.ZP,{item:!0,xs:12,sm:6,children:(0,L.jsx)(B.Z,{label:"H\xecnh th\u1ee9c",data:y.ZP.hinhThucThanhToan,idChosed:null===V||void 0===V?void 0:V.hinhThucThanhToan,handleChange:n=>p("hinhThucThanhToan",n.value)})}),(0,L.jsx)(l.ZP,{item:!0,xs:6,sm:6,children:(0,L.jsx)(x.h3,{fullWidth:!0,size:"small",name:"tongTienThu",label:"Ti\u1ec1n ".concat(q),thousandSeparator:".",decimalSeparator:",",value:null===t||void 0===t?void 0:t.tongTienThu,customInput:s.Z,onChange:n=>{p("tongTienThu",n.target.value)},error:(null===h||void 0===h?void 0:h.tongTienThu)&&Boolean(null===o||void 0===o?void 0:o.tongTienThu),helperText:h.tongTienThu&&o.tongTienThu})}),(0,L.jsx)(l.ZP,{item:!0,xs:12,sm:12,children:(0,L.jsx)(s.Z,{size:"small",multiline:!0,rows:3,fullWidth:!0,label:"N\u1ed9i dung ".concat(q),value:null===t||void 0===t?void 0:t.noiDungThu,onChange:n=>p("noiDungThu",n.target.value)})}),(0,L.jsx)(l.ZP,{item:!0,xs:12,sm:12,style:{display:"none"},children:(0,L.jsx)(d.Z,{children:(0,L.jsx)(r.Z,{value:"end",control:(0,L.jsx)(u.Z,{name:"ckHachToanKinhDoanh",checked:!0===t.hachToanKinhDoanh,onChange:n=>{p("hachToanKinhDoanh",n.target.checked)},value:"true",sx:{color:"#7C3367!important"}}),label:"H\u1ea1ch to\xe1n v\xe0o k\u1ebft qu\u1ea3 ho\u1ea1t \u0111\u1ed9ng kinh doanh"})})}),(0,L.jsx)(l.ZP,{item:!0,xs:12,children:(0,L.jsxs)(c.Z,{spacing:1,direction:"row",justifyContent:"flex-end",children:[(0,L.jsx)(T.Z,{variant:"outlined",sx:{color:"var(--color-main)"},className:"btn-outline-hover",onClick:K,children:"H\u1ee7y"}),a?a&&(0,L.jsx)(T.Z,{variant:"contained",sx:{bgcolor:"#7C3367"},className:"btn-container-hover",type:"submit",children:"\u0110ang l\u01b0u"}):(0,L.jsx)(T.Z,{variant:"contained",sx:{bgcolor:"#7C3367"},className:"btn-container-hover",type:"submit",children:"L\u01b0u"}),!g.Z.checkNull(e)&&(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(T.Z,{variant:"contained",sx:{bgcolor:"red"},className:"btn-container-hover",onClick:()=>{var n,a;W(new N.tf({show:!0,title:"X\xe1c nh\u1eadn x\xf3a",mes:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ".concat(null!==(n=null===V||void 0===V?void 0:V.loaiPhieu)&&void 0!==n?n:" ","  ").concat(null!==(a=null===V||void 0===V?void 0:V.maHoaDon)&&void 0!==a?a:" "," kh\xf4ng?")}))},children:"X\xf3a"})})]})})]})})}})})]})]})}},8922:(n,a,e)=>{e.d(a,{Z:()=>o});var i=e(80280),t=e(96219);const o=new class{constructor(){this.Brandname_CheckExistSDT=async(n,a)=>{if(i.Z.checkNull(n))return!1;return await t.Z.get("api/services/app/Brandname/Brandname_CheckExistSDT?phoneNumber=".concat(n,"&id=").concat(a)).then((n=>n.data.result))},this.GetInforBrandnamebyID=async n=>(await t.Z.get("api/services/app/Brandname/GetInforBrandnamebyID?id=".concat(n))).data.result,this.GetListBandname=async function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(await t.Z.post("api/services/app/Brandname/GetListBandname?tenantId=".concat(a),n)).data.result},this.CreateBrandname=async n=>(await t.Z.post("api/services/app/Brandname/CreateBrandname",n)).data.result,this.UpdateBrandname=async n=>(await t.Z.post("api/services/app/Brandname/UpdateBrandname",n)).data.result,this.XoaBrandname=async n=>(await t.Z.get("api/services/app/Brandname/XoaBrandname?id="+n)).data.result,this.DeleteMultiple_Brandname=async n=>(await t.Z.post("api/services/app/Brandname/DeleteMultiple_Brandname",n)).data.success,this.ActiveMultiple_Brandname=async n=>(await t.Z.post("api/services/app/Brandname/ActiveMultiple_Brandname",n)).data.success,this.ExportToExcel_ListBrandname=async n=>(await t.Z.post("api/services/app/Brandname/ExportToExcel_ListBrandname",n)).data.result}}},93737:(n,a,e)=>{e.d(a,{Z:()=>h});var i=e(68507),t=e(96219),o=e(80280);const h=new class{constructor(){this.ThemMoi_CapNhatPhieuChuyenTien=async(n,a)=>(await t.Z.post("api/services/app/LichSuNap_ChuyenTien/ThemMoi_CapNhatPhieuChuyenTien?tenantId=".concat(n),a)).data.result,this.ThemMoi_CapNhatPhieuNapTien=async(n,a)=>(await t.Z.post("api/services/app/LichSuNap_ChuyenTien/ThemMoi_CapNhatPhieuNapTien?tenantId=".concat(n),a)).data.result,this.GetBrandnameBalance_byUserLogin=async()=>{const n=i.Z.get("userId");if(!o.Z.checkNull(n)){return(await t.Z.get("api/services/app/LichSuNap_ChuyenTien/GetBrandnameBalance_byUserLogin?userId=".concat(n))).data.result}return 0}}}}}]);